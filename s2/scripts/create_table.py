# ---------------------------16-----------------------------------
# create t_4p1_feature_16 (pair feature)
#sql('create table t_4p1_feature_16 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_16_expand_user (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double,user_click_2_add double, user_buy_2_add double,user_click_3_add double, user_buy_3_add double,user_click_4_add double, user_buy_4_add double,user_click_5_add double, user_buy_5_add double,user_click_6_add double, user_buy_6_add double,user_click_7_add double, user_buy_7_add double,user_click_8_add double, user_buy_8_add double,user_click_9_add double, user_buy_9_add double,user_click_10_add double, user_buy_10_add double,user_click_11_add double, user_buy_11_add double,user_click_12_add double, user_buy_12_add double,user_click_13_add double, user_buy_13_add double,user_click_14_add double, user_buy_14_add double,user_click_15_add double, user_buy_15_add double,user_click_16_add double, user_buy_16_add double, user_favorite double, user_cart double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double,user_click_brand_num_2_add double, user_buy_brand_num_2_add double,user_click_brand_num_3_add double, user_buy_brand_num_3_add double,user_click_brand_num_4_add double, user_buy_brand_num_4_add double,user_click_brand_num_5_add double, user_buy_brand_num_5_add double,user_click_brand_num_6_add double, user_buy_brand_num_6_add double,user_click_brand_num_7_add double, user_buy_brand_num_7_add double,user_click_brand_num_8_add double, user_buy_brand_num_8_add double,user_click_brand_num_9_add double, user_buy_brand_num_9_add double,user_click_brand_num_10_add double, user_buy_brand_num_10_add double,user_click_brand_num_11_add double, user_buy_brand_num_11_add double,user_click_brand_num_12_add double, user_buy_brand_num_12_add double,user_click_brand_num_13_add double, user_buy_brand_num_13_add double,user_click_brand_num_14_add double, user_buy_brand_num_14_add double,user_click_brand_num_15_add double, user_buy_brand_num_15_add double,user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_favorite_brand_num double, user_cart_brand_num double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_16_expand_brand
#sql('create table t_4p1_feature_brand_16_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double,brand_click_2_add double, brand_buy_2_add double,brand_click_3_add double, brand_buy_3_add double,brand_click_4_add double, brand_buy_4_add double,brand_click_5_add double, brand_buy_5_add double,brand_click_6_add double, brand_buy_6_add double,brand_click_7_add double, brand_buy_7_add double,brand_click_8_add double, brand_buy_8_add double,brand_click_9_add double, brand_buy_9_add double,brand_click_10_add double, brand_buy_10_add double,brand_click_11_add double, brand_buy_11_add double,brand_click_12_add double, brand_buy_12_add double,brand_click_13_add double, brand_buy_13_add double,brand_click_14_add double, brand_buy_14_add double,brand_click_15_add double, brand_buy_15_add double,brand_click_16_add double, brand_buy_16_add double, brand_favorite double, brand_cart double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double,brand_click_user_num_2_add double, brand_buy_user_num_2_add double,brand_click_user_num_3_add double, brand_buy_user_num_3_add double,brand_click_user_num_4_add double, brand_buy_user_num_4_add double,brand_click_user_num_5_add double, brand_buy_user_num_5_add double,brand_click_user_num_6_add double, brand_buy_user_num_6_add double,brand_click_user_num_7_add double, brand_buy_user_num_7_add double,brand_click_user_num_8_add double, brand_buy_user_num_8_add double,brand_click_user_num_9_add double, brand_buy_user_num_9_add double,brand_click_user_num_10_add double, brand_buy_user_num_10_add double,brand_click_user_num_11_add double, brand_buy_user_num_11_add double,brand_click_user_num_12_add double, brand_buy_user_num_12_add double,brand_click_user_num_13_add double, brand_buy_user_num_13_add double,brand_click_user_num_14_add double, brand_buy_user_num_14_add double,brand_click_user_num_15_add double, brand_buy_user_num_15_add double,brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_favorite_user_num double, brand_cart_user_num double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_16_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add, b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_16_expand_user  a left outer join t_4p1_feature_brand_16_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')

# ---------------------------18-----------------------------------
# create t_4p1_feature_18 (pair feature)
#sql('create table t_4p1_feature_18 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_18_expand_user  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double,user_click_2_add double, user_buy_2_add double,user_click_3_add double, user_buy_3_add double,user_click_4_add double, user_buy_4_add double,user_click_5_add double, user_buy_5_add double,user_click_6_add double, user_buy_6_add double,user_click_7_add double, user_buy_7_add double,user_click_8_add double, user_buy_8_add double,user_click_9_add double, user_buy_9_add double,user_click_10_add double, user_buy_10_add double,user_click_11_add double, user_buy_11_add double,user_click_12_add double, user_buy_12_add double,user_click_13_add double, user_buy_13_add double,user_click_14_add double, user_buy_14_add double,user_click_15_add double, user_buy_15_add double,user_click_16_add double, user_buy_16_add double, user_click_17_add double, user_buy_17_add double, user_click_18_add double, user_buy_18_add double, user_favorite double, user_cart double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double,user_click_brand_num_2_add double, user_buy_brand_num_2_add double,user_click_brand_num_3_add double, user_buy_brand_num_3_add double,user_click_brand_num_4_add double, user_buy_brand_num_4_add double,user_click_brand_num_5_add double, user_buy_brand_num_5_add double,user_click_brand_num_6_add double, user_buy_brand_num_6_add double,user_click_brand_num_7_add double, user_buy_brand_num_7_add double,user_click_brand_num_8_add double, user_buy_brand_num_8_add double,user_click_brand_num_9_add double, user_buy_brand_num_9_add double,user_click_brand_num_10_add double, user_buy_brand_num_10_add double,user_click_brand_num_11_add double, user_buy_brand_num_11_add double,user_click_brand_num_12_add double, user_buy_brand_num_12_add double,user_click_brand_num_13_add double, user_buy_brand_num_13_add double,user_click_brand_num_14_add double, user_buy_brand_num_14_add double,user_click_brand_num_15_add double, user_buy_brand_num_15_add double,user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double,user_click_brand_num_18_add double, user_buy_brand_num_18_add double,user_favorite_brand_num double, user_cart_brand_num double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_18_expand_brand
#sql('create table t_4p1_feature_brand_18_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double,brand_click_2_add double, brand_buy_2_add double,brand_click_3_add double, brand_buy_3_add double,brand_click_4_add double, brand_buy_4_add double,brand_click_5_add double, brand_buy_5_add double,brand_click_6_add double, brand_buy_6_add double,brand_click_7_add double, brand_buy_7_add double,brand_click_8_add double, brand_buy_8_add double,brand_click_9_add double, brand_buy_9_add double,brand_click_10_add double, brand_buy_10_add double,brand_click_11_add double, brand_buy_11_add double,brand_click_12_add double, brand_buy_12_add double,brand_click_13_add double, brand_buy_13_add double,brand_click_14_add double, brand_buy_14_add double,brand_click_15_add double, brand_buy_15_add double,brand_click_16_add double, brand_buy_16_add double,brand_click_17_add double, brand_buy_17_add double,brand_click_18_add double, brand_buy_18_add double, brand_favorite double, brand_cart double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double,brand_click_user_num_2_add double, brand_buy_user_num_2_add double,brand_click_user_num_3_add double, brand_buy_user_num_3_add double,brand_click_user_num_4_add double, brand_buy_user_num_4_add double,brand_click_user_num_5_add double, brand_buy_user_num_5_add double,brand_click_user_num_6_add double, brand_buy_user_num_6_add double,brand_click_user_num_7_add double, brand_buy_user_num_7_add double,brand_click_user_num_8_add double, brand_buy_user_num_8_add double,brand_click_user_num_9_add double, brand_buy_user_num_9_add double,brand_click_user_num_10_add double, brand_buy_user_num_10_add double,brand_click_user_num_11_add double, brand_buy_user_num_11_add double,brand_click_user_num_12_add double, brand_buy_user_num_12_add double,brand_click_user_num_13_add double, brand_buy_user_num_13_add double,brand_click_user_num_14_add double, brand_buy_user_num_14_add double,brand_click_user_num_15_add double, brand_buy_user_num_15_add double,brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double,brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num double, brand_cart_user_num double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_18_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add,b.brand_click_17_add, b.brand_buy_17_add,b.brand_click_18_add, b.brand_buy_18_add, b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add,b.brand_click_user_num_17_add, b.brand_buy_user_num_17_add,b.brand_click_user_num_18_add, b.brand_buy_user_num_18_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_18_expand_user  a left outer join t_4p1_feature_brand_18_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')


# ---------------------------24-----------------------------------
# create t_4p1_feature_24 (pair feature)
#sql('create table t_4p1_feature_24 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, f19_0 bigint,f19_1 bigint,f19_2 bigint,f19_3 bigint, f20_0 bigint,f20_1 bigint,f20_2 bigint,f20_3 bigint, f21_0 bigint,f21_1 bigint,f21_2 bigint,f21_3 bigint, f22_0 bigint,f22_1 bigint,f22_2 bigint,f22_3 bigint, f23_0 bigint,f23_1 bigint,f23_2 bigint,f23_3 bigint, f24_0 bigint,f24_1 bigint,f24_2 bigint,f24_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_24_expand_user  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, f19_0_add double, f19_1_add double, f19_2_add double, f19_3_add double, f20_0_add double, f20_1_add double, f20_2_add double, f20_3_add double, f21_0_add double, f21_1_add double, f21_2_add double, f21_3_add double, f22_0_add double, f22_1_add double, f22_2_add double, f22_3_add double, f23_0_add double, f23_1_add double, f23_2_add double, f23_3_add double, f24_0_add double, f24_1_add double, f24_2_add double, f24_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double,user_click_2_add double, user_buy_2_add double,user_click_3_add double, user_buy_3_add double,user_click_4_add double, user_buy_4_add double,user_click_5_add double, user_buy_5_add double,user_click_6_add double, user_buy_6_add double,user_click_7_add double, user_buy_7_add double,user_click_8_add double, user_buy_8_add double,user_click_9_add double, user_buy_9_add double,user_click_10_add double, user_buy_10_add double,user_click_11_add double, user_buy_11_add double,user_click_12_add double, user_buy_12_add double,user_click_13_add double, user_buy_13_add double,user_click_14_add double, user_buy_14_add double,user_click_15_add double, user_buy_15_add double,user_click_16_add double, user_buy_16_add double, user_click_17_add double, user_buy_17_add double, user_click_18_add double, user_buy_18_add double, user_click_19_add double, user_buy_19_add double, user_click_20_add double, user_buy_20_add double, user_click_21_add double, user_buy_21_add double, user_click_22_add double, user_buy_22_add double, user_click_23_add double, user_buy_23_add double, user_click_24_add double, user_buy_24_add double, user_favorite double, user_cart double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double,user_click_brand_num_2_add double, user_buy_brand_num_2_add double,user_click_brand_num_3_add double, user_buy_brand_num_3_add double,user_click_brand_num_4_add double, user_buy_brand_num_4_add double,user_click_brand_num_5_add double, user_buy_brand_num_5_add double,user_click_brand_num_6_add double, user_buy_brand_num_6_add double,user_click_brand_num_7_add double, user_buy_brand_num_7_add double,user_click_brand_num_8_add double, user_buy_brand_num_8_add double,user_click_brand_num_9_add double, user_buy_brand_num_9_add double,user_click_brand_num_10_add double, user_buy_brand_num_10_add double,user_click_brand_num_11_add double, user_buy_brand_num_11_add double,user_click_brand_num_12_add double, user_buy_brand_num_12_add double,user_click_brand_num_13_add double, user_buy_brand_num_13_add double,user_click_brand_num_14_add double, user_buy_brand_num_14_add double,user_click_brand_num_15_add double, user_buy_brand_num_15_add double,user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double,user_click_brand_num_18_add double, user_buy_brand_num_18_add double,user_click_brand_num_19_add double, user_buy_brand_num_19_add double,user_click_brand_num_20_add double, user_buy_brand_num_20_add double,user_click_brand_num_21_add double, user_buy_brand_num_21_add double,user_click_brand_num_22_add double, user_buy_brand_num_22_add double,user_click_brand_num_23_add double, user_buy_brand_num_23_add double,user_click_brand_num_24_add double, user_buy_brand_num_24_add double,user_favorite_brand_num double, user_cart_brand_num double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_18_expand_brand
#sql('create table t_4p1_feature_brand_18_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double,brand_click_2_add double, brand_buy_2_add double,brand_click_3_add double, brand_buy_3_add double,brand_click_4_add double, brand_buy_4_add double,brand_click_5_add double, brand_buy_5_add double,brand_click_6_add double, brand_buy_6_add double,brand_click_7_add double, brand_buy_7_add double,brand_click_8_add double, brand_buy_8_add double,brand_click_9_add double, brand_buy_9_add double,brand_click_10_add double, brand_buy_10_add double,brand_click_11_add double, brand_buy_11_add double,brand_click_12_add double, brand_buy_12_add double,brand_click_13_add double, brand_buy_13_add double,brand_click_14_add double, brand_buy_14_add double,brand_click_15_add double, brand_buy_15_add double,brand_click_16_add double, brand_buy_16_add double,brand_click_17_add double, brand_buy_17_add double,brand_click_18_add double, brand_buy_18_add double, brand_favorite double, brand_cart double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double,brand_click_user_num_2_add double, brand_buy_user_num_2_add double,brand_click_user_num_3_add double, brand_buy_user_num_3_add double,brand_click_user_num_4_add double, brand_buy_user_num_4_add double,brand_click_user_num_5_add double, brand_buy_user_num_5_add double,brand_click_user_num_6_add double, brand_buy_user_num_6_add double,brand_click_user_num_7_add double, brand_buy_user_num_7_add double,brand_click_user_num_8_add double, brand_buy_user_num_8_add double,brand_click_user_num_9_add double, brand_buy_user_num_9_add double,brand_click_user_num_10_add double, brand_buy_user_num_10_add double,brand_click_user_num_11_add double, brand_buy_user_num_11_add double,brand_click_user_num_12_add double, brand_buy_user_num_12_add double,brand_click_user_num_13_add double, brand_buy_user_num_13_add double,brand_click_user_num_14_add double, brand_buy_user_num_14_add double,brand_click_user_num_15_add double, brand_buy_user_num_15_add double,brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double,brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num double, brand_cart_user_num double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_18_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add,b.brand_click_17_add, b.brand_buy_17_add,b.brand_click_18_add, b.brand_buy_18_add, b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add,b.brand_click_user_num_17_add, b.brand_buy_user_num_17_add,b.brand_click_user_num_18_add, b.brand_buy_user_num_18_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_18_expand_user  a left outer join t_4p1_feature_brand_18_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')

# ---------------------------23-----------------------------------
# create t_4p1_feature_23 (pair feature)
#sql('create table t_4p1_feature_23 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, f19_0 bigint,f19_1 bigint,f19_2 bigint,f19_3 bigint, f20_0 bigint,f20_1 bigint,f20_2 bigint,f20_3 bigint, f21_0 bigint,f21_1 bigint,f21_2 bigint,f21_3 bigint, f22_0 bigint,f22_1 bigint,f22_2 bigint,f22_3 bigint, f23_0 bigint,f23_1 bigint,f23_2 bigint,f23_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_23_expand_user  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, f19_0_add double, f19_1_add double, f19_2_add double, f19_3_add double, f20_0_add double, f20_1_add double, f20_2_add double, f20_3_add double, f21_0_add double, f21_1_add double, f21_2_add double, f21_3_add double, f22_0_add double, f22_1_add double, f22_2_add double, f22_3_add double, f23_0_add double, f23_1_add double, f23_2_add double, f23_3_add double,  click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double, user_favorite_1_add double, user_cart_1_add double, user_click_2_add double, user_buy_2_add double, user_favorite_2_add double, user_cart_2_add double, user_click_3_add double, user_buy_3_add double, user_favorite_3_add double, user_cart_3_add double, user_click_4_add double, user_buy_4_add double, user_favorite_4_add double, user_cart_4_add double, user_click_5_add double, user_buy_5_add double, user_favorite_5_add double, user_cart_5_add double, user_click_6_add double, user_buy_6_add double, user_favorite_6_add double, user_cart_6_add double, user_click_7_add double, user_buy_7_add double, user_favorite_7_add double, user_cart_7_add double, user_click_8_add double, user_buy_8_add double, user_favorite_8_add double, user_cart_8_add double, user_click_9_add double, user_buy_9_add double, user_favorite_9_add double, user_cart_9_add double, user_click_10_add double, user_buy_10_add double, user_favorite_10_add double, user_cart_10_add double, user_click_11_add double, user_buy_11_add double, user_favorite_11_add double, user_cart_11_add double, user_click_12_add double, user_buy_12_add double, user_favorite_12_add double, user_cart_12_add double, user_click_13_add double, user_buy_13_add double, user_favorite_13_add double, user_cart_13_add double, user_click_14_add double, user_buy_14_add double, user_favorite_14_add double, user_cart_14_add double, user_click_15_add double, user_buy_15_add double, user_favorite_15_add double, user_cart_15_add double, user_click_16_add double, user_buy_16_add double, user_favorite_16_add double, user_cart_16_add double, user_click_17_add double, user_buy_17_add double, user_favorite_17_add double, user_cart_17_add double, user_click_18_add double, user_buy_18_add double, user_favorite_18_add double, user_cart_18_add double, user_click_19_add double, user_buy_19_add double, user_favorite_19_add double, user_cart_19_add double, user_click_20_add double, user_buy_20_add double, user_favorite_20_add double, user_cart_20_add double, user_click_21_add double, user_buy_21_add double, user_favorite_21_add double, user_cart_21_add double, user_click_22_add double, user_buy_22_add double, user_favorite_22_add double, user_cart_22_add double, user_click_23_add double, user_buy_23_add double, user_favorite_23_add double, user_cart_23_add double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double, user_favorite_brand_num_1_add double, user_cart_brand_num_1_add double, user_click_brand_num_2_add double, user_buy_brand_num_2_add double, user_favorite_brand_num_2_add double, user_cart_brand_num_2_add double, user_click_brand_num_3_add double, user_buy_brand_num_3_add double, user_favorite_brand_num_3_add double, user_cart_brand_num_3_add double, user_click_brand_num_4_add double, user_buy_brand_num_4_add double, user_favorite_brand_num_4_add double, user_cart_brand_num_4_add double, user_click_brand_num_5_add double, user_buy_brand_num_5_add double, user_favorite_brand_num_5_add double, user_cart_brand_num_5_add double, user_click_brand_num_6_add double, user_buy_brand_num_6_add double, user_favorite_brand_num_6_add double, user_cart_brand_num_6_add double, user_click_brand_num_7_add double, user_buy_brand_num_7_add double, user_favorite_brand_num_7_add double, user_cart_brand_num_7_add double, user_click_brand_num_8_add double, user_buy_brand_num_8_add double, user_favorite_brand_num_8_add double, user_cart_brand_num_8_add double, user_click_brand_num_9_add double, user_buy_brand_num_9_add double, user_favorite_brand_num_9_add double, user_cart_brand_num_9_add double, user_click_brand_num_10_add double, user_buy_brand_num_10_add double, user_favorite_brand_num_10_add double, user_cart_brand_num_10_add double, user_click_brand_num_11_add double, user_buy_brand_num_11_add double, user_favorite_brand_num_11_add double, user_cart_brand_num_11_add double, user_click_brand_num_12_add double, user_buy_brand_num_12_add double, user_favorite_brand_num_12_add double, user_cart_brand_num_12_add double, user_click_brand_num_13_add double, user_buy_brand_num_13_add double, user_favorite_brand_num_13_add double, user_cart_brand_num_13_add double, user_click_brand_num_14_add double, user_buy_brand_num_14_add double, user_favorite_brand_num_14_add double, user_cart_brand_num_14_add double, user_click_brand_num_15_add double, user_buy_brand_num_15_add double, user_favorite_brand_num_15_add double, user_cart_brand_num_15_add double, user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_favorite_brand_num_16_add double, user_cart_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double, user_favorite_brand_num_17_add double, user_cart_brand_num_17_add double, user_click_brand_num_18_add double, user_buy_brand_num_18_add double, user_favorite_brand_num_18_add double, user_cart_brand_num_18_add double, user_click_brand_num_19_add double, user_buy_brand_num_19_add double, user_favorite_brand_num_19_add double, user_cart_brand_num_19_add double, user_click_brand_num_20_add double, user_buy_brand_num_20_add double, user_favorite_brand_num_20_add double, user_cart_brand_num_20_add double, user_click_brand_num_21_add double, user_buy_brand_num_21_add double, user_favorite_brand_num_21_add double, user_cart_brand_num_21_add double, user_click_brand_num_22_add double, user_buy_brand_num_22_add double, user_favorite_brand_num_22_add double, user_cart_brand_num_22_add double, user_click_brand_num_23_add double, user_buy_brand_num_23_add double, user_favorite_brand_num_23_add double, user_cart_brand_num_23_add double,user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_18_expand_brand
#sql('create table t_4p1_feature_brand_18_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double, brand_favorite_1_add double, brand_cart_1_add double, brand_click_2_add double, brand_buy_2_add double, brand_favorite_2_add double, brand_cart_2_add double, brand_click_3_add double, brand_buy_3_add double, brand_favorite_3_add double, brand_cart_3_add double, brand_click_4_add double, brand_buy_4_add double, brand_favorite_4_add double, brand_cart_4_add double, brand_click_5_add double, brand_buy_5_add double, brand_favorite_5_add double, brand_cart_5_add double, brand_click_6_add double, brand_buy_6_add double, brand_favorite_6_add double, brand_cart_6_add double, brand_click_7_add double, brand_buy_7_add double, brand_favorite_7_add double, brand_cart_7_add double, brand_click_8_add double, brand_buy_8_add double, brand_favorite_8_add double, brand_cart_8_add double, brand_click_9_add double, brand_buy_9_add double, brand_favorite_9_add double, brand_cart_9_add double, brand_click_10_add double, brand_buy_10_add double, brand_favorite_10_add double, brand_cart_10_add double, brand_click_11_add double, brand_buy_11_add double, brand_favorite_11_add double, brand_cart_11_add double, brand_click_12_add double, brand_buy_12_add double, brand_favorite_12_add double, brand_cart_12_add double, brand_click_13_add double, brand_buy_13_add double, brand_favorite_13_add double, brand_cart_13_add double, brand_click_14_add double, brand_buy_14_add double, brand_favorite_14_add double, brand_cart_14_add double, brand_click_15_add double, brand_buy_15_add double, brand_favorite_15_add double, brand_cart_15_add double, brand_click_16_add double, brand_buy_16_add double, brand_favorite_16_add double, brand_cart_16_add double, brand_click_17_add double, brand_buy_17_add double, brand_favorite_17_add double, brand_cart_17_add double, brand_click_18_add double, brand_buy_18_add double, brand_favorite_18_add double, brand_cart_18_add double, brand_click_19_add double, brand_buy_19_add double, brand_favorite_19_add double, brand_cart_19_add double, brand_click_20_add double, brand_buy_20_add double, brand_favorite_20_add double, brand_cart_20_add double, brand_click_21_add double, brand_buy_21_add double, brand_favorite_21_add double, brand_cart_21_add double, brand_click_22_add double, brand_buy_22_add double, brand_favorite_22_add double, brand_cart_22_add double, brand_click_23_add double, brand_buy_23_add double, brand_favorite_23_add double, brand_cart_23_add double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double, brand_favorite_user_num_1_add double, brand_cart_user_num_1_add double, brand_click_user_num_2_add double, brand_buy_user_num_2_add double, brand_favorite_user_num_2_add double, brand_cart_user_num_2_add double, brand_click_user_num_3_add double, brand_buy_user_num_3_add double, brand_favorite_user_num_3_add double, brand_cart_user_num_3_add double, brand_click_user_num_4_add double, brand_buy_user_num_4_add double, brand_favorite_user_num_4_add double, brand_cart_user_num_4_add double, brand_click_user_num_5_add double, brand_buy_user_num_5_add double, brand_favorite_user_num_5_add double, brand_cart_user_num_5_add double, brand_click_user_num_6_add double, brand_buy_user_num_6_add double, brand_favorite_user_num_6_add double, brand_cart_user_num_6_add double, brand_click_user_num_7_add double, brand_buy_user_num_7_add double, brand_favorite_user_num_7_add double, brand_cart_user_num_7_add double, brand_click_user_num_8_add double, brand_buy_user_num_8_add double, brand_favorite_user_num_8_add double, brand_cart_user_num_8_add double, brand_click_user_num_9_add double, brand_buy_user_num_9_add double, brand_favorite_user_num_9_add double, brand_cart_user_num_9_add double, brand_click_user_num_10_add double, brand_buy_user_num_10_add double, brand_favorite_user_num_10_add double, brand_cart_user_num_10_add double, brand_click_user_num_11_add double, brand_buy_user_num_11_add double, brand_favorite_user_num_11_add double, brand_cart_user_num_11_add double, brand_click_user_num_12_add double, brand_buy_user_num_12_add double, brand_favorite_user_num_12_add double, brand_cart_user_num_12_add double, brand_click_user_num_13_add double, brand_buy_user_num_13_add double, brand_favorite_user_num_13_add double, brand_cart_user_num_13_add double, brand_click_user_num_14_add double, brand_buy_user_num_14_add double, brand_favorite_user_num_14_add double, brand_cart_user_num_14_add double, brand_click_user_num_15_add double, brand_buy_user_num_15_add double, brand_favorite_user_num_15_add double, brand_cart_user_num_15_add double, brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_favorite_user_num_16_add double, brand_cart_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double, brand_favorite_user_num_17_add double, brand_cart_user_num_17_add double, brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num_18_add double, brand_cart_user_num_18_add double, brand_click_user_num_19_add double, brand_buy_user_num_19_add double, brand_favorite_user_num_19_add double, brand_cart_user_num_19_add double, brand_click_user_num_20_add double, brand_buy_user_num_20_add double, brand_favorite_user_num_20_add double, brand_cart_user_num_20_add double, brand_click_user_num_21_add double, brand_buy_user_num_21_add double, brand_favorite_user_num_21_add double, brand_cart_user_num_21_add double, brand_click_user_num_22_add double, brand_buy_user_num_22_add double, brand_favorite_user_num_22_add double, brand_cart_user_num_22_add double, brand_click_user_num_23_add double, brand_buy_user_num_23_add double, brand_favorite_user_num_23_add double, brand_cart_user_num_23_add double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_23_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add,b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_23_expand_user  a left outer join t_4p1_feature_brand_16_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')

# ---------------------------22-----------------------------------
# create t_4p1_feature_22 (pair feature)
#sql('create table t_4p1_feature_22 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, f19_0 bigint,f19_1 bigint,f19_2 bigint,f19_3 bigint, f20_0 bigint,f20_1 bigint,f20_2 bigint,f20_3 bigint, f21_0 bigint,f21_1 bigint,f21_2 bigint,f21_3 bigint, f22_0 bigint,f22_1 bigint,f22_2 bigint,f22_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

sql('create table t_4p1_feature_pair_user_22_expand_user_all  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, f19_0_add double, f19_1_add double, f19_2_add double, f19_3_add double, f20_0_add double, f20_1_add double, f20_2_add double, f20_3_add double, f21_0_add double, f21_1_add double, f21_2_add double, f21_3_add double, f22_0_add double, f22_1_add double, f22_2_add double, f22_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double, user_favorite_1_add double, user_cart_1_add double, user_click_2_add double, user_buy_2_add double, user_favorite_2_add double, user_cart_2_add double, user_click_3_add double, user_buy_3_add double, user_favorite_3_add double, user_cart_3_add double, user_click_4_add double, user_buy_4_add double, user_favorite_4_add double, user_cart_4_add double, user_click_5_add double, user_buy_5_add double, user_favorite_5_add double, user_cart_5_add double, user_click_6_add double, user_buy_6_add double, user_favorite_6_add double, user_cart_6_add double, user_click_7_add double, user_buy_7_add double, user_favorite_7_add double, user_cart_7_add double, user_click_8_add double, user_buy_8_add double, user_favorite_8_add double, user_cart_8_add double, user_click_9_add double, user_buy_9_add double, user_favorite_9_add double, user_cart_9_add double, user_click_10_add double, user_buy_10_add double, user_favorite_10_add double, user_cart_10_add double, user_click_11_add double, user_buy_11_add double, user_favorite_11_add double, user_cart_11_add double, user_click_12_add double, user_buy_12_add double, user_favorite_12_add double, user_cart_12_add double, user_click_13_add double, user_buy_13_add double, user_favorite_13_add double, user_cart_13_add double, user_click_14_add double, user_buy_14_add double, user_favorite_14_add double, user_cart_14_add double, user_click_15_add double, user_buy_15_add double, user_favorite_15_add double, user_cart_15_add double, user_click_16_add double, user_buy_16_add double, user_favorite_16_add double, user_cart_16_add double, user_click_17_add double, user_buy_17_add double, user_favorite_17_add double, user_cart_17_add double, user_click_18_add double, user_buy_18_add double, user_favorite_18_add double, user_cart_18_add double, user_click_19_add double, user_buy_19_add double, user_favorite_19_add double, user_cart_19_add double, user_click_20_add double, user_buy_20_add double, user_favorite_20_add double, user_cart_20_add double, user_click_21_add double, user_buy_21_add double, user_favorite_21_add double, user_cart_21_add double, user_click_22_add double, user_buy_22_add double, user_favorite_22_add double, user_cart_22_add double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double, user_favorite_brand_num_1_add double, user_cart_brand_num_1_add double, user_click_brand_num_2_add double, user_buy_brand_num_2_add double, user_favorite_brand_num_2_add double, user_cart_brand_num_2_add double, user_click_brand_num_3_add double, user_buy_brand_num_3_add double, user_favorite_brand_num_3_add double, user_cart_brand_num_3_add double, user_click_brand_num_4_add double, user_buy_brand_num_4_add double, user_favorite_brand_num_4_add double, user_cart_brand_num_4_add double, user_click_brand_num_5_add double, user_buy_brand_num_5_add double, user_favorite_brand_num_5_add double, user_cart_brand_num_5_add double, user_click_brand_num_6_add double, user_buy_brand_num_6_add double, user_favorite_brand_num_6_add double, user_cart_brand_num_6_add double, user_click_brand_num_7_add double, user_buy_brand_num_7_add double, user_favorite_brand_num_7_add double, user_cart_brand_num_7_add double, user_click_brand_num_8_add double, user_buy_brand_num_8_add double, user_favorite_brand_num_8_add double, user_cart_brand_num_8_add double, user_click_brand_num_9_add double, user_buy_brand_num_9_add double, user_favorite_brand_num_9_add double, user_cart_brand_num_9_add double, user_click_brand_num_10_add double, user_buy_brand_num_10_add double, user_favorite_brand_num_10_add double, user_cart_brand_num_10_add double, user_click_brand_num_11_add double, user_buy_brand_num_11_add double, user_favorite_brand_num_11_add double, user_cart_brand_num_11_add double, user_click_brand_num_12_add double, user_buy_brand_num_12_add double, user_favorite_brand_num_12_add double, user_cart_brand_num_12_add double, user_click_brand_num_13_add double, user_buy_brand_num_13_add double, user_favorite_brand_num_13_add double, user_cart_brand_num_13_add double, user_click_brand_num_14_add double, user_buy_brand_num_14_add double, user_favorite_brand_num_14_add double, user_cart_brand_num_14_add double, user_click_brand_num_15_add double, user_buy_brand_num_15_add double, user_favorite_brand_num_15_add double, user_cart_brand_num_15_add double, user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_favorite_brand_num_16_add double, user_cart_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double, user_favorite_brand_num_17_add double, user_cart_brand_num_17_add double, user_click_brand_num_18_add double, user_buy_brand_num_18_add double, user_favorite_brand_num_18_add double, user_cart_brand_num_18_add double, user_click_brand_num_19_add double, user_buy_brand_num_19_add double, user_favorite_brand_num_19_add double, user_cart_brand_num_19_add double, user_click_brand_num_20_add double, user_buy_brand_num_20_add double, user_favorite_brand_num_20_add double, user_cart_brand_num_20_add double, user_click_brand_num_21_add double, user_buy_brand_num_21_add double, user_favorite_brand_num_21_add double, user_cart_brand_num_21_add double, user_click_brand_num_22_add double, user_buy_brand_num_22_add double, user_favorite_brand_num_22_add double, user_cart_brand_num_22_add double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_22_expand_brand
sql('create table t_4p1_feature_brand_22_expand_brand_all  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double, brand_favorite_1_add double, brand_cart_1_add double, brand_click_2_add double, brand_buy_2_add double, brand_favorite_2_add double, brand_cart_2_add double, brand_click_3_add double, brand_buy_3_add double, brand_favorite_3_add double, brand_cart_3_add double, brand_click_4_add double, brand_buy_4_add double, brand_favorite_4_add double, brand_cart_4_add double, brand_click_5_add double, brand_buy_5_add double, brand_favorite_5_add double, brand_cart_5_add double, brand_click_6_add double, brand_buy_6_add double, brand_favorite_6_add double, brand_cart_6_add double, brand_click_7_add double, brand_buy_7_add double, brand_favorite_7_add double, brand_cart_7_add double, brand_click_8_add double, brand_buy_8_add double, brand_favorite_8_add double, brand_cart_8_add double, brand_click_9_add double, brand_buy_9_add double, brand_favorite_9_add double, brand_cart_9_add double, brand_click_10_add double, brand_buy_10_add double, brand_favorite_10_add double, brand_cart_10_add double, brand_click_11_add double, brand_buy_11_add double, brand_favorite_11_add double, brand_cart_11_add double, brand_click_12_add double, brand_buy_12_add double, brand_favorite_12_add double, brand_cart_12_add double, brand_click_13_add double, brand_buy_13_add double, brand_favorite_13_add double, brand_cart_13_add double, brand_click_14_add double, brand_buy_14_add double, brand_favorite_14_add double, brand_cart_14_add double, brand_click_15_add double, brand_buy_15_add double, brand_favorite_15_add double, brand_cart_15_add double, brand_click_16_add double, brand_buy_16_add double, brand_favorite_16_add double, brand_cart_16_add double, brand_click_17_add double, brand_buy_17_add double, brand_favorite_17_add double, brand_cart_17_add double, brand_click_18_add double, brand_buy_18_add double, brand_favorite_18_add double, brand_cart_18_add double, brand_click_19_add double, brand_buy_19_add double, brand_favorite_19_add double, brand_cart_19_add double, brand_click_20_add double, brand_buy_20_add double, brand_favorite_20_add double, brand_cart_20_add double, brand_click_21_add double, brand_buy_21_add double, brand_favorite_21_add double, brand_cart_21_add double, brand_click_22_add double, brand_buy_22_add double, brand_favorite_22_add double, brand_cart_22_add double,  brand_click_user_num_1_add double, brand_buy_user_num_1_add double, brand_favorite_user_num_1_add double, brand_cart_user_num_1_add double, brand_click_user_num_2_add double, brand_buy_user_num_2_add double, brand_favorite_user_num_2_add double, brand_cart_user_num_2_add double, brand_click_user_num_3_add double, brand_buy_user_num_3_add double, brand_favorite_user_num_3_add double, brand_cart_user_num_3_add double, brand_click_user_num_4_add double, brand_buy_user_num_4_add double, brand_favorite_user_num_4_add double, brand_cart_user_num_4_add double, brand_click_user_num_5_add double, brand_buy_user_num_5_add double, brand_favorite_user_num_5_add double, brand_cart_user_num_5_add double, brand_click_user_num_6_add double, brand_buy_user_num_6_add double, brand_favorite_user_num_6_add double, brand_cart_user_num_6_add double, brand_click_user_num_7_add double, brand_buy_user_num_7_add double, brand_favorite_user_num_7_add double, brand_cart_user_num_7_add double, brand_click_user_num_8_add double, brand_buy_user_num_8_add double, brand_favorite_user_num_8_add double, brand_cart_user_num_8_add double, brand_click_user_num_9_add double, brand_buy_user_num_9_add double, brand_favorite_user_num_9_add double, brand_cart_user_num_9_add double, brand_click_user_num_10_add double, brand_buy_user_num_10_add double, brand_favorite_user_num_10_add double, brand_cart_user_num_10_add double, brand_click_user_num_11_add double, brand_buy_user_num_11_add double, brand_favorite_user_num_11_add double, brand_cart_user_num_11_add double, brand_click_user_num_12_add double, brand_buy_user_num_12_add double, brand_favorite_user_num_12_add double, brand_cart_user_num_12_add double, brand_click_user_num_13_add double, brand_buy_user_num_13_add double, brand_favorite_user_num_13_add double, brand_cart_user_num_13_add double, brand_click_user_num_14_add double, brand_buy_user_num_14_add double, brand_favorite_user_num_14_add double, brand_cart_user_num_14_add double, brand_click_user_num_15_add double, brand_buy_user_num_15_add double, brand_favorite_user_num_15_add double, brand_cart_user_num_15_add double, brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_favorite_user_num_16_add double, brand_cart_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double, brand_favorite_user_num_17_add double, brand_cart_user_num_17_add double, brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num_18_add double, brand_cart_user_num_18_add double, brand_click_user_num_19_add double, brand_buy_user_num_19_add double, brand_favorite_user_num_19_add double, brand_cart_user_num_19_add double, brand_click_user_num_20_add double, brand_buy_user_num_20_add double, brand_favorite_user_num_20_add double, brand_cart_user_num_20_add double, brand_click_user_num_21_add double, brand_buy_user_num_21_add double, brand_favorite_user_num_21_add double, brand_cart_user_num_21_add double, brand_click_user_num_22_add double, brand_buy_user_num_22_add double, brand_favorite_user_num_22_add double, brand_cart_user_num_22_add double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_22_expand_all as select a.*, b.brand_click_1_add, b.brand_buy_1_add, b.brand_favorite_1_add, b.brand_cart_1_add, b.brand_click_2_add, b.brand_buy_2_add, b.brand_favorite_2_add, b.brand_cart_2_add, b.brand_click_3_add, b.brand_buy_3_add, b.brand_favorite_3_add, b.brand_cart_3_add, b.brand_click_4_add, b.brand_buy_4_add, b.brand_favorite_4_add, b.brand_cart_4_add, b.brand_click_5_add, b.brand_buy_5_add, b.brand_favorite_5_add, b.brand_cart_5_add, b.brand_click_6_add, b.brand_buy_6_add, b.brand_favorite_6_add, b.brand_cart_6_add, b.brand_click_7_add, b.brand_buy_7_add, b.brand_favorite_7_add, b.brand_cart_7_add, b.brand_click_8_add, b.brand_buy_8_add, b.brand_favorite_8_add, b.brand_cart_8_add, b.brand_click_9_add, b.brand_buy_9_add, b.brand_favorite_9_add, b.brand_cart_9_add, b.brand_click_10_add, b.brand_buy_10_add, b.brand_favorite_10_add, b.brand_cart_10_add, b.brand_click_11_add, b.brand_buy_11_add, b.brand_favorite_11_add, b.brand_cart_11_add, b.brand_click_12_add, b.brand_buy_12_add, b.brand_favorite_12_add, b.brand_cart_12_add, b.brand_click_13_add, b.brand_buy_13_add, b.brand_favorite_13_add, b.brand_cart_13_add, b.brand_click_14_add, b.brand_buy_14_add, b.brand_favorite_14_add, b.brand_cart_14_add, b.brand_click_15_add, b.brand_buy_15_add, b.brand_favorite_15_add, b.brand_cart_15_add, b.brand_click_16_add, b.brand_buy_16_add, b.brand_favorite_16_add, b.brand_cart_16_add, b.brand_click_17_add, b.brand_buy_17_add, b.brand_favorite_17_add, b.brand_cart_17_add, b.brand_click_18_add, b.brand_buy_18_add, b.brand_favorite_18_add, b.brand_cart_18_add, b.brand_click_19_add, b.brand_buy_19_add, b.brand_favorite_19_add, b.brand_cart_19_add, b.brand_click_20_add, b.brand_buy_20_add, b.brand_favorite_20_add, b.brand_cart_20_add, b.brand_click_21_add, b.brand_buy_21_add, b.brand_favorite_21_add, b.brand_cart_21_add, b.brand_click_22_add, b.brand_buy_22_add, b.brand_favorite_22_add, b.brand_cart_22_add, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,  b.brand_click_user_num_22_add, b.brand_buy_user_num_22_add, b.brand_favorite_user_num_22_add, b.brand_cart_user_num_22_add, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_22_expand_user_all  a left outer join t_4p1_feature_brand_22_expand_brand_all  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')

# ---------------------------21-----------------------------------
# create t_4p1_feature_21 (pair feature)
#sql('create table t_4p1_feature_21 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, f19_0 bigint,f19_1 bigint,f19_2 bigint,f19_3 bigint, f20_0 bigint,f20_1 bigint,f20_2 bigint,f20_3 bigint, f21_0 bigint,f21_1 bigint,f21_2 bigint,f21_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_21_expand_user  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, f19_0_add double, f19_1_add double, f19_2_add double, f19_3_add double, f20_0_add double, f20_1_add double, f20_2_add double, f20_3_add double, f21_0_add double, f21_1_add double, f21_2_add double, f21_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double,user_click_2_add double, user_buy_2_add double,user_click_3_add double, user_buy_3_add double,user_click_4_add double, user_buy_4_add double,user_click_5_add double, user_buy_5_add double,user_click_6_add double, user_buy_6_add double,user_click_7_add double, user_buy_7_add double,user_click_8_add double, user_buy_8_add double,user_click_9_add double, user_buy_9_add double,user_click_10_add double, user_buy_10_add double,user_click_11_add double, user_buy_11_add double,user_click_12_add double, user_buy_12_add double,user_click_13_add double, user_buy_13_add double,user_click_14_add double, user_buy_14_add double,user_click_15_add double, user_buy_15_add double,user_click_16_add double, user_buy_16_add double, user_click_17_add double, user_buy_17_add double, user_click_18_add double, user_buy_18_add double, user_click_19_add double, user_buy_19_add double, user_click_20_add double, user_buy_20_add double, user_click_21_add double, user_buy_21_add double, user_favorite double, user_cart double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double,user_click_brand_num_2_add double, user_buy_brand_num_2_add double,user_click_brand_num_3_add double, user_buy_brand_num_3_add double,user_click_brand_num_4_add double, user_buy_brand_num_4_add double,user_click_brand_num_5_add double, user_buy_brand_num_5_add double,user_click_brand_num_6_add double, user_buy_brand_num_6_add double,user_click_brand_num_7_add double, user_buy_brand_num_7_add double,user_click_brand_num_8_add double, user_buy_brand_num_8_add double,user_click_brand_num_9_add double, user_buy_brand_num_9_add double,user_click_brand_num_10_add double, user_buy_brand_num_10_add double,user_click_brand_num_11_add double, user_buy_brand_num_11_add double,user_click_brand_num_12_add double, user_buy_brand_num_12_add double,user_click_brand_num_13_add double, user_buy_brand_num_13_add double,user_click_brand_num_14_add double, user_buy_brand_num_14_add double,user_click_brand_num_15_add double, user_buy_brand_num_15_add double,user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double,user_click_brand_num_18_add double, user_buy_brand_num_18_add double,user_click_brand_num_19_add double, user_buy_brand_num_19_add double,user_click_brand_num_20_add double, user_buy_brand_num_20_add double,user_click_brand_num_21_add double, user_buy_brand_num_21_add double,user_favorite_brand_num double, user_cart_brand_num double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_18_expand_brand
#sql('create table t_4p1_feature_brand_18_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double,brand_click_2_add double, brand_buy_2_add double,brand_click_3_add double, brand_buy_3_add double,brand_click_4_add double, brand_buy_4_add double,brand_click_5_add double, brand_buy_5_add double,brand_click_6_add double, brand_buy_6_add double,brand_click_7_add double, brand_buy_7_add double,brand_click_8_add double, brand_buy_8_add double,brand_click_9_add double, brand_buy_9_add double,brand_click_10_add double, brand_buy_10_add double,brand_click_11_add double, brand_buy_11_add double,brand_click_12_add double, brand_buy_12_add double,brand_click_13_add double, brand_buy_13_add double,brand_click_14_add double, brand_buy_14_add double,brand_click_15_add double, brand_buy_15_add double,brand_click_16_add double, brand_buy_16_add double,brand_click_17_add double, brand_buy_17_add double,brand_click_18_add double, brand_buy_18_add double, brand_favorite double, brand_cart double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double,brand_click_user_num_2_add double, brand_buy_user_num_2_add double,brand_click_user_num_3_add double, brand_buy_user_num_3_add double,brand_click_user_num_4_add double, brand_buy_user_num_4_add double,brand_click_user_num_5_add double, brand_buy_user_num_5_add double,brand_click_user_num_6_add double, brand_buy_user_num_6_add double,brand_click_user_num_7_add double, brand_buy_user_num_7_add double,brand_click_user_num_8_add double, brand_buy_user_num_8_add double,brand_click_user_num_9_add double, brand_buy_user_num_9_add double,brand_click_user_num_10_add double, brand_buy_user_num_10_add double,brand_click_user_num_11_add double, brand_buy_user_num_11_add double,brand_click_user_num_12_add double, brand_buy_user_num_12_add double,brand_click_user_num_13_add double, brand_buy_user_num_13_add double,brand_click_user_num_14_add double, brand_buy_user_num_14_add double,brand_click_user_num_15_add double, brand_buy_user_num_15_add double,brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double,brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num double, brand_cart_user_num double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_18_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add,b.brand_click_17_add, b.brand_buy_17_add,b.brand_click_18_add, b.brand_buy_18_add, b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add,b.brand_click_user_num_17_add, b.brand_buy_user_num_17_add,b.brand_click_user_num_18_add, b.brand_buy_user_num_18_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_18_expand_user  a left outer join t_4p1_feature_brand_18_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')

# ---------------------------20-----------------------------------
# create t_4p1_feature_20 (pair feature)
#sql('create table t_4p1_feature_20 (flag bigint, user_id string, brand_id string, f1_0 bigint,f1_1 bigint,f1_2 bigint,f1_3 bigint,f2_0 bigint,f2_1 bigint,f2_2 bigint,f2_3 bigint,f3_0 bigint,f3_1 bigint,f3_2 bigint,f3_3 bigint,f4_0 bigint,f4_1 bigint,f4_2 bigint,f4_3 bigint,f5_0 bigint,f5_1 bigint,f5_2 bigint,f5_3 bigint,f6_0 bigint,f6_1 bigint,f6_2 bigint,f6_3 bigint,f7_0 bigint,f7_1 bigint,f7_2 bigint,f7_3 bigint,f8_0 bigint,f8_1 bigint,f8_2 bigint,f8_3 bigint,f9_0 bigint,f9_1 bigint,f9_2 bigint,f9_3 bigint,f10_0 bigint,f10_1 bigint,f10_2 bigint,f10_3 bigint,f11_0 bigint,f11_1 bigint,f11_2 bigint,f11_3 bigint,f12_0 bigint,f12_1 bigint,f12_2 bigint,f12_3 bigint,f13_0 bigint,f13_1 bigint,f13_2 bigint,f13_3 bigint,f14_0 bigint,f14_1 bigint,f14_2 bigint,f14_3 bigint,f15_0 bigint,f15_1 bigint,f15_2 bigint,f15_3 bigint,f16_0 bigint,f16_1 bigint,f16_2 bigint,f16_3 bigint, f17_0 bigint,f17_1 bigint,f17_2 bigint,f17_3 bigint, f18_0 bigint,f18_1 bigint,f18_2 bigint,f18_3 bigint, f19_0 bigint,f19_1 bigint,f19_2 bigint,f19_3 bigint, f20_0 bigint,f20_1 bigint,f20_2 bigint,f20_3 bigint, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double);')

#sql('create table t_4p1_feature_pair_user_20_expand_user  (flag bigint, user_id string, brand_id string, f1_0_add double, f1_1_add double, f1_2_add double, f1_3_add double, f2_0_add double, f2_1_add double,f2_2_add double, f2_3_add double, f3_0_add double, f3_1_add double, f3_2_add double, f3_3_add double, f4_0_add double, f4_1_add double, f4_2_add double, f4_3_add double, f5_0_add double, f5_1_add double, f5_2_add double, f5_3_add double, f6_0_add double, f6_1_add double, f6_2_add double, f6_3_add double, f7_0_add double, f7_1_add double, f7_2_add double, f7_3_add double, f8_0_add double, f8_1_add double, f8_2_add double, f8_3_add double, f9_0_add double, f9_1_add double, f9_2_add double, f9_3_add double, f10_0_add double, f10_1_add double, f10_2_add double, f10_3_add double, f11_0_add double, f11_1_add double, f11_2_add double, f11_3_add double, f12_0_add double, f12_1_add double, f12_2_add double, f12_3_add double, f13_0_add double, f13_1_add double, f13_2_add double, f13_3_add double, f14_0_add double, f14_1_add double, f14_2_add double, f14_3_add double, f15_0_add double, f15_1_add double, f15_2_add double, f15_3_add double, f16_0_add double, f16_1_add double, f16_2_add double, f16_3_add double, f17_0_add double, f17_1_add double, f17_2_add double, f17_3_add double, f18_0_add double, f18_1_add double, f18_2_add double, f18_3_add double, f19_0_add double, f19_1_add double, f19_2_add double, f19_3_add double, f20_0_add double, f20_1_add double, f20_2_add double, f20_3_add double, click_before_buy double, favorite_before_buy double, cart_before_buy double, click_after_buy double, favorite_after_buy double, cart_after_buy double, time_between_buy double, time_after_buy double, avg_click_before_buy double, avg_favorite_before_buy double, avg_cart_before_buy double, avg_time_between_buy double, user_click_1_add double, user_buy_1_add double,user_click_2_add double, user_buy_2_add double,user_click_3_add double, user_buy_3_add double,user_click_4_add double, user_buy_4_add double,user_click_5_add double, user_buy_5_add double,user_click_6_add double, user_buy_6_add double,user_click_7_add double, user_buy_7_add double,user_click_8_add double, user_buy_8_add double,user_click_9_add double, user_buy_9_add double,user_click_10_add double, user_buy_10_add double,user_click_11_add double, user_buy_11_add double,user_click_12_add double, user_buy_12_add double,user_click_13_add double, user_buy_13_add double,user_click_14_add double, user_buy_14_add double,user_click_15_add double, user_buy_15_add double,user_click_16_add double, user_buy_16_add double, user_click_17_add double, user_buy_17_add double, user_click_18_add double, user_buy_18_add double, user_click_19_add double, user_buy_19_add double, user_click_20_add double, user_buy_20_add double, user_favorite double, user_cart double, user_click_brand_num_1_add double, user_buy_brand_num_1_add double,user_click_brand_num_2_add double, user_buy_brand_num_2_add double,user_click_brand_num_3_add double, user_buy_brand_num_3_add double,user_click_brand_num_4_add double, user_buy_brand_num_4_add double,user_click_brand_num_5_add double, user_buy_brand_num_5_add double,user_click_brand_num_6_add double, user_buy_brand_num_6_add double,user_click_brand_num_7_add double, user_buy_brand_num_7_add double,user_click_brand_num_8_add double, user_buy_brand_num_8_add double,user_click_brand_num_9_add double, user_buy_brand_num_9_add double,user_click_brand_num_10_add double, user_buy_brand_num_10_add double,user_click_brand_num_11_add double, user_buy_brand_num_11_add double,user_click_brand_num_12_add double, user_buy_brand_num_12_add double,user_click_brand_num_13_add double, user_buy_brand_num_13_add double,user_click_brand_num_14_add double, user_buy_brand_num_14_add double,user_click_brand_num_15_add double, user_buy_brand_num_15_add double,user_click_brand_num_16_add double, user_buy_brand_num_16_add double, user_click_brand_num_17_add double, user_buy_brand_num_17_add double,user_click_brand_num_18_add double, user_buy_brand_num_18_add double,user_click_brand_num_19_add double, user_buy_brand_num_19_add double,user_click_brand_num_20_add double, user_buy_brand_num_20_add double,user_favorite_brand_num double, user_cart_brand_num double, user_effective_click double, user_effective_favorite double, user_effective_cart double, user_time_between_buy double, user_avg_click_with_buy double, user_avg_favorite_with_buy double, user_avg_cart_with_buy double, user_avg_time_between_buy double);')
# create t_4p1_feature_brand_18_expand_brand
#sql('create table t_4p1_feature_brand_18_expand_brand  (flag bigint, brand_id string, user_id string, brand_click_1_add double, brand_buy_1_add double,brand_click_2_add double, brand_buy_2_add double,brand_click_3_add double, brand_buy_3_add double,brand_click_4_add double, brand_buy_4_add double,brand_click_5_add double, brand_buy_5_add double,brand_click_6_add double, brand_buy_6_add double,brand_click_7_add double, brand_buy_7_add double,brand_click_8_add double, brand_buy_8_add double,brand_click_9_add double, brand_buy_9_add double,brand_click_10_add double, brand_buy_10_add double,brand_click_11_add double, brand_buy_11_add double,brand_click_12_add double, brand_buy_12_add double,brand_click_13_add double, brand_buy_13_add double,brand_click_14_add double, brand_buy_14_add double,brand_click_15_add double, brand_buy_15_add double,brand_click_16_add double, brand_buy_16_add double,brand_click_17_add double, brand_buy_17_add double,brand_click_18_add double, brand_buy_18_add double, brand_favorite double, brand_cart double, brand_click_user_num_1_add double, brand_buy_user_num_1_add double,brand_click_user_num_2_add double, brand_buy_user_num_2_add double,brand_click_user_num_3_add double, brand_buy_user_num_3_add double,brand_click_user_num_4_add double, brand_buy_user_num_4_add double,brand_click_user_num_5_add double, brand_buy_user_num_5_add double,brand_click_user_num_6_add double, brand_buy_user_num_6_add double,brand_click_user_num_7_add double, brand_buy_user_num_7_add double,brand_click_user_num_8_add double, brand_buy_user_num_8_add double,brand_click_user_num_9_add double, brand_buy_user_num_9_add double,brand_click_user_num_10_add double, brand_buy_user_num_10_add double,brand_click_user_num_11_add double, brand_buy_user_num_11_add double,brand_click_user_num_12_add double, brand_buy_user_num_12_add double,brand_click_user_num_13_add double, brand_buy_user_num_13_add double,brand_click_user_num_14_add double, brand_buy_user_num_14_add double,brand_click_user_num_15_add double, brand_buy_user_num_15_add double,brand_click_user_num_16_add double, brand_buy_user_num_16_add double, brand_click_user_num_17_add double, brand_buy_user_num_17_add double,brand_click_user_num_18_add double, brand_buy_user_num_18_add double, brand_favorite_user_num double, brand_cart_user_num double, brand_effective_click double, brand_effective_favorite double, brand_effective_cart double, brand_time_between_buy double, brand_avg_click_with_buy double, brand_avg_favorite_with_buy double, brand_avg_cart_with_buy double, brand_avg_time_between_buy double);')
# join tables
#sql('create table t_4p1_feature_user_brand_18_expand  as select a.*, b.brand_click_1_add, b.brand_buy_1_add,b.brand_click_2_add, b.brand_buy_2_add,b.brand_click_3_add, b.brand_buy_3_add,b.brand_click_4_add, b.brand_buy_4_add,b.brand_click_5_add, b.brand_buy_5_add,b.brand_click_6_add, b.brand_buy_6_add,b.brand_click_7_add, b.brand_buy_7_add,b.brand_click_8_add, b.brand_buy_8_add,b.brand_click_9_add, b.brand_buy_9_add,b.brand_click_10_add, b.brand_buy_10_add,b.brand_click_11_add, b.brand_buy_11_add,b.brand_click_12_add, b.brand_buy_12_add,b.brand_click_13_add, b.brand_buy_13_add,b.brand_click_14_add, b.brand_buy_14_add,b.brand_click_15_add, b.brand_buy_15_add,b.brand_click_16_add, b.brand_buy_16_add,b.brand_click_17_add, b.brand_buy_17_add,b.brand_click_18_add, b.brand_buy_18_add, b.brand_favorite, b.brand_cart, b.brand_click_user_num_1_add, b.brand_buy_user_num_1_add,b.brand_click_user_num_2_add, b.brand_buy_user_num_2_add,b.brand_click_user_num_3_add, b.brand_buy_user_num_3_add,b.brand_click_user_num_4_add, b.brand_buy_user_num_4_add,b.brand_click_user_num_5_add, b.brand_buy_user_num_5_add,b.brand_click_user_num_6_add, b.brand_buy_user_num_6_add,b.brand_click_user_num_7_add, b.brand_buy_user_num_7_add,b.brand_click_user_num_8_add, b.brand_buy_user_num_8_add,b.brand_click_user_num_9_add, b.brand_buy_user_num_9_add,b.brand_click_user_num_10_add, b.brand_buy_user_num_10_add,b.brand_click_user_num_11_add, b.brand_buy_user_num_11_add,b.brand_click_user_num_12_add, b.brand_buy_user_num_12_add,b.brand_click_user_num_13_add, b.brand_buy_user_num_13_add,b.brand_click_user_num_14_add, b.brand_buy_user_num_14_add,b.brand_click_user_num_15_add, b.brand_buy_user_num_15_add,b.brand_click_user_num_16_add, b.brand_buy_user_num_16_add,b.brand_click_user_num_17_add, b.brand_buy_user_num_17_add,b.brand_click_user_num_18_add, b.brand_buy_user_num_18_add, b.brand_favorite_user_num, b.brand_cart_user_num, b.brand_effective_click, b.brand_effective_favorite, b.brand_effective_cart, b.brand_time_between_buy, b.brand_avg_click_with_buy, b.brand_avg_favorite_with_buy, b.brand_avg_cart_with_buy, b.brand_avg_time_between_buy from t_4p1_feature_pair_user_18_expand_user  a left outer join t_4p1_feature_brand_18_expand_brand  b on a.user_id=b.user_id and a.brand_id=b.brand_id and a.flag= b.flag;')
